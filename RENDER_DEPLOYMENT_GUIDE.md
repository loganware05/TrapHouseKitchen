# üöÄ Render Deployment Guide - TrapHouse Kitchen

**Platform:** Render.com  
**Estimated Time:** 30 minutes  
**Monthly Cost:** $14-21 (after free trial)

---

## üìã **Pre-Deployment Checklist**

Before deploying, ensure you have:

- [ ] GitHub account
- [ ] Code pushed to GitHub repository
- [ ] Render account (sign up at render.com)
- [ ] Stripe API keys (test or live)
- [ ] (Optional) Resend API key for email notifications
- [ ] (Optional) Custom domain ready

---

## üéØ **Step 1: Prepare Your GitHub Repository**

### **1.1 Create GitHub Repository**

If you haven't already:

```bash
# Initialize git (if not done)
cd "/Users/loganware/Documents/Buisness/TrapHouseKitchen v2"
git init

# Add all files
git add .

# Commit
git commit -m "Initial commit - Ready for production deployment"

# Create repository on GitHub.com, then:
git remote add origin https://github.com/YOUR_USERNAME/traphouse-kitchen.git
git branch -M main
git push -u origin main
```

### **1.2 Verify Repository Contents**

Ensure these files are in your repository:
- ‚úÖ `render.yaml` (Render configuration)
- ‚úÖ `backend/` directory with all backend code
- ‚úÖ `frontend/` directory with all frontend code
- ‚úÖ `backend/prisma/schema.prisma` (database schema)
- ‚úÖ `.gitignore` (excludes node_modules, .env)

**DO NOT commit:**
- ‚ùå `.env` files (use `.env.example` instead)
- ‚ùå `node_modules/`
- ‚ùå `dist/` or `build/` directories

---

## üöÄ **Step 2: Deploy to Render**

### **2.1 Sign Up for Render**

1. Go to [render.com](https://render.com)
2. Click "Get Started" or "Sign Up"
3. **Sign up with GitHub** (recommended for easy integration)
4. Authorize Render to access your GitHub repositories

### **2.2 Create New Blueprint**

1. **From Render Dashboard:**
   - Click "New +" in top right
   - Select **"Blueprint"**

2. **Connect Repository:**
   - Select your GitHub repository: `traphouse-kitchen`
   - Render will detect the `render.yaml` file automatically
   - Click "Apply"

3. **Review Services:**
   Render will show 3 services it's about to create:
   - `traphousekitchen-db` (PostgreSQL Database)
   - `traphousekitchen-api` (Backend API)
   - `traphousekitchen-web` (Frontend)

4. **Click "Create Services"**

---

## üîê **Step 3: Configure Environment Variables**

### **3.1 Backend API Environment Variables**

Go to `traphousekitchen-api` service ‚Üí Environment tab

**Required Variables:**

```bash
# JWT Secret (Auto-generated by Render)
JWT_SECRET=<auto-generated>

# Stripe Keys (Get from dashboard.stripe.com)
STRIPE_PUBLISHABLE_KEY=pk_live_YOUR_KEY_HERE
STRIPE_SECRET_KEY=sk_live_YOUR_KEY_HERE

# Chef Email (for order notifications)
CHEF_EMAIL=chef@yourdomain.com
```

**Optional but Recommended:**

```bash
# Email Service (Get from resend.com)
RESEND_API_KEY=re_YOUR_KEY_HERE
FROM_EMAIL=TrapHouse Kitchen <orders@yourdomain.com>
```

**Already Auto-Configured:**
- ‚úÖ `DATABASE_URL` (from PostgreSQL service)
- ‚úÖ `FRONTEND_URL` (from frontend service)
- ‚úÖ `NODE_ENV=production`
- ‚úÖ `PORT=3001`
- ‚úÖ `JWT_EXPIRES_IN=7d`

### **3.2 Frontend Environment Variables**

Go to `traphousekitchen-web` service ‚Üí Environment tab

**Required Variables:**

```bash
# Stripe Publishable Key (same as backend)
VITE_STRIPE_PUBLISHABLE_KEY=pk_live_YOUR_KEY_HERE
```

**Already Auto-Configured:**
- ‚úÖ `VITE_API_URL` (from backend service)

### **3.3 How to Add Variables**

1. Click service name (e.g., `traphousekitchen-api`)
2. Go to "Environment" tab
3. Click "Add Environment Variable"
4. Enter key and value
5. Click "Save Changes"
6. Service will automatically redeploy

---

## üóÑÔ∏è **Step 4: Database Setup**

### **4.1 Wait for Database Creation**

The PostgreSQL database (`traphousekitchen-db`) will be created first. Wait until status shows "Available" (2-5 minutes).

### **4.2 Run Database Migrations**

The backend service will automatically run migrations when it starts:
- Command: `npx prisma migrate deploy`
- This happens automatically in the `startCommand`

### **4.3 Seed Database (Optional)**

To add initial data (chef account, categories, allergens):

1. Go to `traphousekitchen-api` service
2. Click "Shell" tab
3. Run:
   ```bash
   cd backend
   npm run prisma:seed
   ```

**Alternative:** Use the seed SQL file:

1. Go to `traphousekitchen-db` service
2. Note the connection details
3. Connect with psql or a database client
4. Run the SQL from `backend/prisma/seed.sql`

---

## ‚úÖ **Step 5: Verify Deployment**

### **5.1 Check Service Status**

All three services should show "Live" status:
- ‚úÖ `traphousekitchen-db` - Available
- ‚úÖ `traphousekitchen-api` - Live
- ‚úÖ `traphousekitchen-web` - Live

### **5.2 Get Your URLs**

**Backend API URL:**
- Format: `https://traphousekitchen-api.onrender.com`
- Test: `https://traphousekitchen-api.onrender.com/health`
- Should return: `{"status":"ok","timestamp":"..."}`

**Frontend URL:**
- Format: `https://traphousekitchen-web.onrender.com`
- Open in browser to access your application

### **5.3 Test Core Features**

1. **Frontend Loads:**
   - Visit frontend URL
   - Should see homepage

2. **Chef Login:**
   - Go to `/chef/login`
   - Email: `chef@traphouse.com`
   - Password: `chef123`
   - Should login successfully

3. **Customer Registration:**
   - Register a new account
   - Should receive confirmation

4. **Create Order:**
   - Login as customer
   - Add item to cart
   - Complete checkout
   - Should work end-to-end

5. **Payment Test:**
   - Use test card: `4242 4242 4242 4242`
   - Should process successfully

---

## üåê **Step 6: Custom Domain (Optional)**

### **6.1 Add Custom Domain to Frontend**

1. Go to `traphousekitchen-web` service
2. Click "Settings" ‚Üí "Custom Domain"
3. Add your domain (e.g., `traphousekitchen.com`)
4. Follow DNS configuration instructions
5. Render will automatically provision SSL certificate

### **6.2 Add Custom Domain to Backend**

1. Go to `traphousekitchen-api` service
2. Click "Settings" ‚Üí "Custom Domain"
3. Add subdomain (e.g., `api.traphousekitchen.com`)
4. Update DNS records

### **6.3 Update Environment Variables**

After adding custom domains, update:

**Backend:**
```bash
FRONTEND_URL=https://traphousekitchen.com
```

**Frontend:**
```bash
VITE_API_URL=https://api.traphousekitchen.com/api
```

---

## üîß **Step 7: Production Configuration**

### **7.1 Enable Auto-Deploy**

Render automatically deploys when you push to your GitHub repository:

1. Make changes locally
2. Commit and push to GitHub
3. Render detects changes and deploys automatically
4. Monitor deployment in Render dashboard

### **7.2 Set Up Monitoring**

1. **Render Dashboard:**
   - View logs in real-time
   - Monitor resource usage
   - Check deployment history

2. **Set Up Alerts:**
   - Go to service ‚Üí Notifications
   - Add email/Slack notifications for:
     - Deploy failures
     - Service downtime
     - Resource limits

### **7.3 Configure Backups**

Database backups are automatic on Render:
- Daily automatic backups
- Retained for 7 days (Starter plan)
- Manual backups available in dashboard

---

## üí∞ **Step 8: Pricing & Billing**

### **Free Trial:**
- PostgreSQL: 90 days free
- Web Services: 750 hours/month free
- Static Sites: Free forever

### **After Free Trial:**

**Recommended Plan (Starter):**
```
PostgreSQL Database:  $7/month
Backend API Service:  $7/month
Frontend Static Site: $0/month (free tier)
------------------------
Total:               $14/month
```

**Optional Upgrades:**
```
Standard Plan (more resources):
- Database: $15/month
- Backend: $15/month
Total: $30/month
```

### **8.1 Add Payment Method**

1. Go to Account Settings ‚Üí Billing
2. Add credit card
3. Services will continue running after free trial

---

## üêõ **Troubleshooting**

### **Issue: Backend Deploy Fails**

**Check:**
1. Go to `traphousekitchen-api` ‚Üí Logs
2. Look for error messages

**Common Fixes:**
```bash
# Missing environment variables
‚Üí Add STRIPE_SECRET_KEY and other required vars

# Database connection failed
‚Üí Check DATABASE_URL is set correctly

# Build errors
‚Üí Check package.json dependencies
‚Üí Verify TypeScript compiles locally: npm run build
```

### **Issue: Frontend Shows API Errors**

**Check:**
1. Is backend URL correct in `VITE_API_URL`?
2. Is CORS configured properly?
3. Check backend logs for errors

**Fix:**
```bash
# Update frontend environment variable
VITE_API_URL=https://YOUR-BACKEND-URL.onrender.com/api
```

### **Issue: Database Migration Fails**

**Fix:**
1. Go to backend service ‚Üí Shell
2. Run manually:
   ```bash
   cd backend
   npx prisma migrate deploy
   npx prisma generate
   ```

### **Issue: "Cannot find module '@prisma/client'"**

**Fix:**
```bash
# In backend service shell:
cd backend
npx prisma generate
```

### **Issue: Cold Starts (Free Tier)**

On free tier, services "sleep" after 15 minutes of inactivity:
- First request after sleep takes 30-60 seconds
- Upgrade to Starter plan ($7/month) to eliminate cold starts

---

## üìä **Post-Deployment Checklist**

After successful deployment:

- [ ] All services showing "Live" status
- [ ] Backend health check responds
- [ ] Frontend loads in browser
- [ ] Chef can login
- [ ] Customer can register
- [ ] Menu displays dishes
- [ ] Orders can be created
- [ ] Payments process (test mode)
- [ ] Email notifications work (if configured)
- [ ] Custom domain configured (if applicable)
- [ ] Monitoring/alerts set up
- [ ] Billing information added

---

## üéØ **Next Steps**

### **Immediate:**
1. Test all features thoroughly
2. Create first real chef account
3. Add real menu items
4. Test with real customers

### **Within 1 Week:**
1. Switch Stripe to live mode (if ready)
2. Set up custom domain
3. Configure email service (Resend)
4. Add restaurant information
5. Test payment flow with small real transactions

### **Within 1 Month:**
1. Monitor performance
2. Gather customer feedback
3. Review analytics
4. Plan feature improvements
5. Consider upgrading plan if needed

---

## üìû **Support Resources**

### **Render Support:**
- Documentation: [render.com/docs](https://render.com/docs)
- Community Forum: [community.render.com](https://community.render.com)
- Support Email: support@render.com
- Status Page: [status.render.com](https://status.render.com)

### **Application Issues:**
- Check service logs in Render dashboard
- Review application documentation
- Check GitHub repository for updates

---

## üéâ **Congratulations!**

Your TrapHouse Kitchen application is now live and accessible to the world!

**Your URLs:**
- Frontend: `https://traphousekitchen-web.onrender.com`
- Backend API: `https://traphousekitchen-api.onrender.com`

**Share with:**
- Your team
- Test customers
- Social media
- Local community

**Start accepting real orders! üçΩÔ∏è**
