# Render Deployment Guide - TrapHouse Kitchen

**Platform:** Render.com  
**Estimated Time:** 30 minutes  
**Monthly Cost:** $14-21 (after free trial)

---

## Quick Start

Get your app live in 3 steps:

### Step 1: Push to GitHub (5 minutes)

```bash
cd "/Users/loganware/Documents/Buisness/TrapHouseKitchen v2"
git init
git add .
git commit -m "Ready for production deployment"

# Create repository on GitHub.com, then:
git remote add origin https://github.com/YOUR_USERNAME/traphouse-kitchen.git
git branch -M main
git push -u origin main
```

### Step 2: Deploy on Render (15 minutes)

1. **Sign up:**
   - Go to [render.com](https://render.com)
   - Sign up with GitHub (recommended)
   - Authorize Render to access repositories

2. **Create Blueprint:**
   - Click "New +" ‚Üí "Blueprint"
   - Select your repository: `traphouse-kitchen`
   - Render detects `render.yaml` automatically
   - Review 3 services:
     - `traphousekitchen-db` (PostgreSQL)
     - `traphousekitchen-api` (Backend)
     - `traphousekitchen-web` (Frontend)
   - Click "Create Services"

3. **Configure Environment Variables:**

**Backend (`traphousekitchen-api`):**
```bash
STRIPE_SECRET_KEY=sk_test_YOUR_KEY
STRIPE_PUBLISHABLE_KEY=pk_test_YOUR_KEY
CHEF_EMAIL=your-email@example.com

# Optional (for emails):
RESEND_API_KEY=re_your_key_here
FROM_EMAIL=TrapHouse Kitchen <orders@yourdomain.com>
```

**Frontend (`traphousekitchen-web`):**
```bash
VITE_STRIPE_PUBLISHABLE_KEY=pk_test_YOUR_KEY
```

### Step 3: Verify & Test (10 minutes)

1. **Get Your URLs:**
   - Frontend: `https://traphousekitchen-web.onrender.com`
   - Backend: `https://traphousekitchen-api.onrender.com`

2. **Health Check:**
   ```
   Visit: https://YOUR-BACKEND-URL.onrender.com/health
   Should return: {"status":"ok","timestamp":"..."}
   ```

3. **Test Features:**
   - Frontend loads ‚úÖ
   - Chef login (chef@traphouse.com / chef123) ‚úÖ
   - Customer registration ‚úÖ
   - Menu browsing ‚úÖ
   - Order placement ‚úÖ
   - Test payment (4242 4242 4242 4242) ‚úÖ

---

## Pre-Deployment Checklist

- [ ] GitHub account
- [ ] Code pushed to GitHub repository
- [ ] Render account
- [ ] Stripe API keys (test or live)
- [ ] (Optional) Resend API key for emails
- [ ] (Optional) Custom domain ready

---

## Environment Variables

### Backend Variables

**Required:**
- `DATABASE_URL` - Auto-configured from PostgreSQL service
- `JWT_SECRET` - Auto-generated by Render
- `STRIPE_SECRET_KEY` - Get from dashboard.stripe.com
- `STRIPE_PUBLISHABLE_KEY` - Get from dashboard.stripe.com
- `CHEF_EMAIL` - Email for order notifications

**Optional:**
- `RESEND_API_KEY` - For email notifications
- `FROM_EMAIL` - Sender email address

**Auto-Configured:**
- `FRONTEND_URL` - From frontend service
- `NODE_ENV` - Set to production
- `PORT` - Usually 10000
- `JWT_EXPIRES_IN` - Set to 7d

### Frontend Variables

**Required:**
- `VITE_STRIPE_PUBLISHABLE_KEY` - Same as backend publishable key

**Auto-Configured:**
- `VITE_API_URL` - From backend service

### How to Add Variables

1. Click service name (e.g., `traphousekitchen-api`)
2. Go to "Environment" tab
3. Click "Add Environment Variable"
4. Enter key and value
5. Click "Save Changes"
6. Service will automatically redeploy

---

## Database Setup

### Automatic Migration

The backend service automatically runs migrations on startup:
- Command: `npx prisma migrate deploy`
- Happens in the `startCommand`

### Seed Database (Optional)

To add initial data:

1. Go to `traphousekitchen-api` service
2. Click "Shell" tab
3. Run:
   ```bash
   cd backend
   npm run prisma:seed
   ```

**Alternative:** Use the seed SQL file from `backend/prisma/seed.sql`

---

## Custom Domain (Optional)

### Add Custom Domain to Frontend

1. Go to `traphousekitchen-web` service
2. Click "Settings" ‚Üí "Custom Domain"
3. Add your domain (e.g., `traphousekitchen.com`)
4. Follow DNS configuration instructions
5. Render automatically provisions SSL certificate

### Add Custom Domain to Backend

1. Go to `traphousekitchen-api` service
2. Click "Settings" ‚Üí "Custom Domain"
3. Add subdomain (e.g., `api.traphousekitchen.com`)
4. Update DNS records

### Update Environment Variables

After adding custom domains:

**Backend:**
```bash
FRONTEND_URL=https://traphousekitchen.com
```

**Frontend:**
```bash
VITE_API_URL=https://api.traphousekitchen.com/api
```

---

## Production Configuration

### Auto-Deploy

Render automatically deploys when you push to GitHub:

1. Make changes locally
2. Commit and push to GitHub
3. Render detects changes and deploys
4. Monitor deployment in dashboard

### Monitoring

1. **View Logs:**
   - Click service ‚Üí "Logs" tab
   - Real-time log viewing
   - Filter by log level

2. **Set Up Alerts:**
   - Go to service ‚Üí "Notifications"
   - Add email/Slack notifications for:
     - Deploy failures
     - Service downtime
     - Resource limits

### Backups

Database backups are automatic:
- Daily automatic backups
- Retained for 7 days (Starter plan)
- Manual backups available in dashboard

---

## Pricing & Billing

### Free Trial
- PostgreSQL: 90 days free
- Web Services: 750 hours/month free
- Static Sites: Free forever

### Recommended Plan (Starter)
```
PostgreSQL Database:  $7/month
Backend API Service:  $7/month
Frontend Static Site: Free
------------------------
Total:               $14/month
```

### Optional Upgrades
```
Standard Plan:
- Database: $15/month
- Backend: $15/month
Total: $30/month
```

### Add Payment Method

1. Go to Account Settings ‚Üí Billing
2. Add credit card
3. Services continue after free trial

---

## Troubleshooting

### Backend Deploy Fails

**Check:**
1. Go to `traphousekitchen-api` ‚Üí Logs
2. Look for error messages

**Common Fixes:**
```bash
# Missing environment variables
‚Üí Add STRIPE_SECRET_KEY and other required vars

# Database connection failed
‚Üí Check DATABASE_URL is set correctly

# Build errors
‚Üí Verify TypeScript compiles locally: npm run build
```

### Frontend Shows API Errors

**Check:**
1. Is backend URL correct in `VITE_API_URL`?
2. Is CORS configured properly?
3. Check backend logs for errors

**Fix:**
```bash
VITE_API_URL=https://YOUR-BACKEND-URL.onrender.com/api
```

### Database Migration Fails

**Fix:**
1. Go to backend service ‚Üí Shell
2. Run manually:
   ```bash
   cd backend
   npx prisma migrate deploy
   npx prisma generate
   ```

### "Cannot find module '@prisma/client'"

**Fix:**
```bash
# In backend service shell:
cd backend
npx prisma generate
```

### Cold Starts (Free Tier)

On free tier, services "sleep" after 15 minutes:
- First request takes 30-60 seconds
- Upgrade to Starter ($7/month) to eliminate cold starts

---

## Post-Deployment Checklist

- [ ] All services showing "Live" status
- [ ] Backend health check responds
- [ ] Frontend loads in browser
- [ ] Chef can login
- [ ] Customer can register
- [ ] Menu displays dishes
- [ ] Orders can be created
- [ ] Payments process (test mode)
- [ ] Email notifications work (if configured)
- [ ] Custom domain configured (if applicable)
- [ ] Monitoring/alerts set up
- [ ] Billing information added

---

## Next Steps

### Immediate
1. Test all features thoroughly
2. Create first real chef account
3. Add real menu items
4. Test with real customers

### Within 1 Week
1. Switch Stripe to live mode (if ready)
2. Set up custom domain
3. Configure email service
4. Test payment flow with small transactions

### Within 1 Month
1. Monitor performance
2. Gather customer feedback
3. Review analytics
4. Plan feature improvements
5. Consider upgrading plan if needed

---

## Support Resources

- **Render Docs:** [render.com/docs](https://render.com/docs)
- **Community:** [community.render.com](https://community.render.com)
- **Support:** support@render.com
- **Status Page:** [status.render.com](https://status.render.com)

---

**Your app is now live! üéâ**

**Production URLs:**
- Frontend: `https://traphousekitchen-web.onrender.com`
- Backend API: `https://traphousekitchen-api.onrender.com`

**Start accepting real orders! üçΩÔ∏è**
